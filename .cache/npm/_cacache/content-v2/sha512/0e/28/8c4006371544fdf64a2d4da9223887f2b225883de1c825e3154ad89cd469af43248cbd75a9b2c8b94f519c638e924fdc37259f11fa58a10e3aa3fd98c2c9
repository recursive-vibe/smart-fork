{"_id":"cc-safety-net","_rev":"8-bb1e9ab2c74db522565350e7e9927c68","name":"cc-safety-net","dist-tags":{"latest":"0.6.2"},"versions":{"0.0.1":{"name":"cc-safety-net","version":"0.0.1","_id":"cc-safety-net@0.0.1","maintainers":[{"name":"kenryu","email":"ken0ryu@gmail.com"}],"dist":{"shasum":"d88de80874abb150ec73842d11e7f21bdf6d59a9","tarball":"https://registry.npmjs.org/cc-safety-net/-/cc-safety-net-0.0.1.tgz","fileCount":2,"integrity":"sha512-FsUtqFGkKQmsZODLZUzg/w4uMp8xWZIoCrJ2NWDAZs7SfBppo0Mspca7zedAv9EouuNcNe6wUK2YqwjxFvTAeQ==","signatures":[{"sig":"MEQCIEy0rcAL8375WW7dTSBJEsAIxgm+LgYUVVg0Pyk/+OXPAiB5b7+NcFf2CR3DuK31eqC0Hd78gz9DCMHfvTOcSiZk6A==","keyid":"SHA256:DhQ8wR5APBvFHLF/+Tc+AYvPOdTpcIDqOhxsBHRwC7U"}],"unpackedSize":455},"type":"module","module":"index.ts","_npmUser":{"name":"kenryu","email":"ken0ryu@gmail.com"},"_npmVersion":"11.6.2","description":"To install dependencies:","directories":{},"_nodeVersion":"24.11.1","_hasShrinkwrap":false,"devDependencies":{"@types/bun":"latest"},"peerDependencies":{"typescript":"^5"},"_npmOperationalInternal":{"tmp":"tmp/cc-safety-net_0.0.1_1767445497695_0.6056249420605639","host":"s3://npm-registry-packages-npm-production"}},"0.4.0":{"name":"cc-safety-net","version":"0.4.0","keywords":["claude-code","opencode","safety","plugin","security"],"author":{"name":"J Liew","email":"jliew@420024lab.com"},"license":"MIT","_id":"cc-safety-net@0.4.0","maintainers":[{"name":"kenryu","email":"ken0ryu@gmail.com"}],"homepage":"https://github.com/kenryu42/claude-code-safety-net#readme","bugs":{"url":"https://github.com/kenryu42/claude-code-safety-net/issues"},"bin":{"cc-safety-net":"dist/bin/cc-safety-net.js"},"dist":{"shasum":"2a97575996fea4c2ab64de4cdbfe2b1f31588dc0","tarball":"https://registry.npmjs.org/cc-safety-net/-/cc-safety-net-0.4.0.tgz","fileCount":30,"integrity":"sha512-pUMN/gnAqvq6nVro1hMlY8oFGXBJLUwM6uXbhsG8xo020r/AGX73+GiZhg90I9AHD4a1q1R0FZrDFLrWxpnrhg==","signatures":[{"sig":"MEYCIQCG45N/CDrhRTU3gV+HgtP953Tc9rB38XKMhxKWpl5qjAIhAJzC/rDQ6n/RfhzGt2Ur5rdVcIk2jMqfnI/iYJS1beR1","keyid":"SHA256:DhQ8wR5APBvFHLF/+Tc+AYvPOdTpcIDqOhxsBHRwC7U"}],"unpackedSize":167246},"main":"dist/index.js","type":"module","types":"dist/index.d.ts","engines":{"node":">=18"},"gitHead":"b554f6ad8f110367083ae63e0c76d73fe6d9ed76","scripts":{"knip":"knip --production","lint":"biome check --write","test":"bun test","build":"bun build src/index.ts src/bin/cc-safety-net.ts --outdir dist --target node && bun run build:types && bun run build:schema","check":"bun run lint && bun run typecheck && bun run knip && bun run sg:scan && AGENT=1 bun test","clean":"rm -rf dist","prepare":"husky && bun run setup-hooks","sg:scan":"ast-grep scan","typecheck":"tsc --project tsconfig.typecheck.json","build:types":"tsc --emitDeclarationOnly --declaration --noEmit false","setup-hooks":"bun -e 'await Bun.write(\".husky/pre-commit\", \"#!/usr/bin/env sh\\n\\nbun run knip && bun run lint-staged\\n\")' && chmod +x .husky/pre-commit","build:schema":"bun run scripts/build-schema.ts"},"_npmUser":{"name":"kenryu","email":"ken0ryu@gmail.com"},"repository":{"url":"git+https://github.com/kenryu42/claude-code-safety-net.git","type":"git"},"_npmVersion":"11.6.2","description":"Claude Code / OpenCode plugin - block destructive git and filesystem commands before execution","directories":{},"_nodeVersion":"24.11.1","dependencies":{"shell-quote":"^1.8.3"},"_hasShrinkwrap":false,"devDependencies":{"zod":"^4.3.5","knip":"^5.79.0","husky":"^9.1.7","@types/bun":"latest","lint-staged":"^16.2.7","@ast-grep/cli":"^0.40.4","@biomejs/biome":"2.3.10","@types/shell-quote":"^1.7.5","@opencode-ai/plugin":"^1.0.224"},"peerDependencies":{"typescript":"^5"},"trustedDependencies":["@ast-grep/cli"],"_npmOperationalInternal":{"tmp":"tmp/cc-safety-net_0.4.0_1767784515865_0.1000180262079815","host":"s3://npm-registry-packages-npm-production"}},"0.4.1":{"name":"cc-safety-net","version":"0.4.1","keywords":["claude-code","opencode","safety","plugin","security"],"author":{"name":"J Liew","email":"jliew@420024lab.com"},"license":"MIT","_id":"cc-safety-net@0.4.1","maintainers":[{"name":"kenryu","email":"ken0ryu@gmail.com"}],"homepage":"https://github.com/kenryu42/claude-code-safety-net#readme","bugs":{"url":"https://github.com/kenryu42/claude-code-safety-net/issues"},"bin":{"cc-safety-net":"dist/bin/cc-safety-net.js"},"dist":{"shasum":"591ae1fa41004a24b3d888e7e5eda48dd5bd5e7b","tarball":"https://registry.npmjs.org/cc-safety-net/-/cc-safety-net-0.4.1.tgz","fileCount":30,"integrity":"sha512-6l4Uc07YEfQjSNO7XQOGCiZog9vWjCQNlea3Yv6e4QAV0nXbMJz+kbBquArL7iKQv7a43MAhs5UCtQNiRdZ6HA==","signatures":[{"sig":"MEQCICwde1+qeKUcEwzN3Os0hZRVamUQTWn3vZDf/oeuHZsZAiBjyPJOElnDwHm2072xvn9QOl3s571IGEgpcCayWLWXrg==","keyid":"SHA256:DhQ8wR5APBvFHLF/+Tc+AYvPOdTpcIDqOhxsBHRwC7U"}],"attestations":{"url":"https://registry.npmjs.org/-/npm/v1/attestations/cc-safety-net@0.4.1","provenance":{"predicateType":"https://slsa.dev/provenance/v1"}},"unpackedSize":167407},"main":"dist/index.js","type":"module","types":"dist/index.d.ts","engines":{"node":">=18"},"gitHead":"d158d8fd41bb70d0ff2011941f4babb533e9d088","scripts":{"knip":"knip --production","lint":"biome check --write","test":"bun test","build":"bun build src/index.ts src/bin/cc-safety-net.ts --outdir dist --target node && bun run build:types && bun run build:schema","check":"bun run lint && bun run typecheck && bun run knip && bun run sg:scan && AGENT=1 bun test","clean":"rm -rf dist","prepare":"husky && bun run setup-hooks","sg:scan":"ast-grep scan","typecheck":"tsc --project tsconfig.typecheck.json","build:types":"tsc --emitDeclarationOnly --declaration --noEmit false","setup-hooks":"bun -e 'await Bun.write(\".husky/pre-commit\", \"#!/usr/bin/env sh\\n\\nbun run knip && bun run lint-staged\\n\")' && chmod +x .husky/pre-commit","build:schema":"bun run scripts/build-schema.ts"},"_npmUser":{"name":"GitHub Actions","email":"npm-oidc-no-reply@github.com","trustedPublisher":{"id":"github","oidcConfigId":"oidc:28db2ca7-f17e-4d43-894b-e6eeff723077"}},"repository":{"url":"git+https://github.com/kenryu42/claude-code-safety-net.git","type":"git"},"_npmVersion":"11.7.0","description":"Claude Code / OpenCode plugin - block destructive git and filesystem commands before execution","directories":{},"_nodeVersion":"24.12.0","dependencies":{"shell-quote":"^1.8.3"},"_hasShrinkwrap":false,"devDependencies":{"zod":"^4.3.5","knip":"^5.79.0","husky":"^9.1.7","@types/bun":"latest","lint-staged":"^16.2.7","@ast-grep/cli":"^0.40.4","@biomejs/biome":"2.3.10","@types/shell-quote":"^1.7.5","@opencode-ai/plugin":"^1.0.224"},"peerDependencies":{"typescript":"^5"},"trustedDependencies":["@ast-grep/cli"],"_npmOperationalInternal":{"tmp":"tmp/cc-safety-net_0.4.1_1767893727031_0.3637673237626111","host":"s3://npm-registry-packages-npm-production"}},"0.5.0":{"name":"cc-safety-net","version":"0.5.0","keywords":["claude-code","opencode","safety","plugin","security"],"author":{"name":"J Liew","email":"jliew@420024lab.com"},"license":"MIT","_id":"cc-safety-net@0.5.0","maintainers":[{"name":"kenryu","email":"ken0ryu@gmail.com"}],"homepage":"https://github.com/kenryu42/claude-code-safety-net#readme","bugs":{"url":"https://github.com/kenryu42/claude-code-safety-net/issues"},"bin":{"cc-safety-net":"dist/bin/cc-safety-net.js"},"dist":{"shasum":"284f52e3b3238634584002cd6ef03cae1edfd8fb","tarball":"https://registry.npmjs.org/cc-safety-net/-/cc-safety-net-0.5.0.tgz","fileCount":30,"integrity":"sha512-rf6WSrdQsCj0irkVFFvFYNUXb9B7AaqN7ayrqJCk/GcIiy8c2KrRgkp9Tvkz7n0EMjGGrcSa4Mh3obHQkFhsog==","signatures":[{"sig":"MEQCIBrKqqSFPthhfq67vIC+hxofZxFhdahmK1odrOhw1NRFAiBB2nuqqjTFyXT9dRS+19sF/UugpsTYCv4P7lam31jnPw==","keyid":"SHA256:DhQ8wR5APBvFHLF/+Tc+AYvPOdTpcIDqOhxsBHRwC7U"}],"attestations":{"url":"https://registry.npmjs.org/-/npm/v1/attestations/cc-safety-net@0.5.0","provenance":{"predicateType":"https://slsa.dev/provenance/v1"}},"unpackedSize":175071},"main":"dist/index.js","type":"module","types":"dist/index.d.ts","engines":{"node":">=18"},"gitHead":"2df2d88a5f044d0d759c80310717453e2a9d9067","scripts":{"knip":"knip --production","lint":"biome check --write","test":"bun test","build":"bun build src/index.ts src/bin/cc-safety-net.ts --outdir dist --target node && bun run build:types && bun run build:schema","check":"bun run lint && bun run typecheck && bun run knip && bun run sg:scan && AGENT=1 bun test --coverage","clean":"rm -rf dist","prepare":"husky && bun run setup-hooks","sg:scan":"ast-grep scan","typecheck":"tsc --project tsconfig.typecheck.json","build:types":"tsc --emitDeclarationOnly --declaration --noEmit false","setup-hooks":"bun -e 'await Bun.write(\".husky/pre-commit\", \"#!/usr/bin/env sh\\n\\nbun run knip && bun run lint-staged\\n\")' && chmod +x .husky/pre-commit","build:schema":"bun run scripts/build-schema.ts"},"_npmUser":{"name":"GitHub Actions","email":"npm-oidc-no-reply@github.com","trustedPublisher":{"id":"github","oidcConfigId":"oidc:28db2ca7-f17e-4d43-894b-e6eeff723077"}},"repository":{"url":"git+https://github.com/kenryu42/claude-code-safety-net.git","type":"git"},"_npmVersion":"11.7.0","description":"Claude Code / OpenCode plugin - block destructive git and filesystem commands before execution","directories":{},"_nodeVersion":"24.12.0","dependencies":{"shell-quote":"^1.8.3"},"_hasShrinkwrap":false,"devDependencies":{"zod":"^4.3.5","knip":"^5.79.0","husky":"^9.1.7","@types/bun":"latest","lint-staged":"^16.2.7","@ast-grep/cli":"^0.40.4","@biomejs/biome":"2.3.10","@types/shell-quote":"^1.7.5","@opencode-ai/plugin":"^1.0.224"},"peerDependencies":{"typescript":"^5"},"trustedDependencies":["@ast-grep/cli"],"_npmOperationalInternal":{"tmp":"tmp/cc-safety-net_0.5.0_1768070742928_0.7666290936231195","host":"s3://npm-registry-packages-npm-production"}},"0.5.1":{"name":"cc-safety-net","version":"0.5.1","keywords":["claude-code","opencode","safety","plugin","security"],"author":{"name":"J Liew","email":"jliew@420024lab.com"},"license":"MIT","_id":"cc-safety-net@0.5.1","maintainers":[{"name":"kenryu","email":"ken0ryu@gmail.com"}],"homepage":"https://github.com/kenryu42/claude-code-safety-net#readme","bugs":{"url":"https://github.com/kenryu42/claude-code-safety-net/issues"},"bin":{"cc-safety-net":"dist/bin/cc-safety-net.js"},"dist":{"shasum":"3076fd74e8a0d21f96d9a18f78c21724260b0e87","tarball":"https://registry.npmjs.org/cc-safety-net/-/cc-safety-net-0.5.1.tgz","fileCount":35,"integrity":"sha512-cf3S5NqHYrxqeqbKXPEFHoJfzbKeqHNgJVgNjEi4Jqb169JxC2SuPWa9MI1pxgoFrtaBQAfE861d1JoEFbs9iA==","signatures":[{"sig":"MEUCIDYAvfMiLHdgONYayyO0V/Fn/vePPHlsSu1eAW/BVW2/AiEA9sC5nSZIDf/Epi02UmEU1oFIJ149Y6nZLts6f3CAQjA=","keyid":"SHA256:DhQ8wR5APBvFHLF/+Tc+AYvPOdTpcIDqOhxsBHRwC7U"}],"attestations":{"url":"https://registry.npmjs.org/-/npm/v1/attestations/cc-safety-net@0.5.1","provenance":{"predicateType":"https://slsa.dev/provenance/v1"}},"unpackedSize":181571},"main":"dist/index.js","type":"module","types":"dist/index.d.ts","engines":{"node":">=18"},"gitHead":"a2a5a8c21d74e5531ce94c238cc643205919b316","scripts":{"knip":"knip --production","lint":"biome check --write","test":"bun test","build":"bun build src/index.ts src/bin/cc-safety-net.ts --outdir dist --target node && bun run build:types && bun run build:schema","check":"bun run lint && bun run typecheck && bun run knip && bun run sg:scan && AGENT=1 bun test --coverage","clean":"rm -rf dist","prepare":"husky && bun run setup-hooks","sg:scan":"ast-grep scan","typecheck":"tsc --project tsconfig.typecheck.json","build:types":"tsc --emitDeclarationOnly --declaration --noEmit false","setup-hooks":"bun -e 'await Bun.write(\".husky/pre-commit\", \"#!/usr/bin/env sh\\n\\nbun run knip && bun run lint-staged\\n\")' && chmod +x .husky/pre-commit","build:schema":"bun run scripts/build-schema.ts"},"_npmUser":{"name":"GitHub Actions","email":"npm-oidc-no-reply@github.com","trustedPublisher":{"id":"github","oidcConfigId":"oidc:28db2ca7-f17e-4d43-894b-e6eeff723077"}},"repository":{"url":"git+https://github.com/kenryu42/claude-code-safety-net.git","type":"git"},"_npmVersion":"11.7.0","description":"Claude Code / OpenCode plugin - block destructive git and filesystem commands before execution","directories":{},"_nodeVersion":"24.12.0","dependencies":{"shell-quote":"^1.8.3"},"_hasShrinkwrap":false,"devDependencies":{"zod":"^4.3.5","knip":"^5.79.0","husky":"^9.1.7","@types/bun":"latest","lint-staged":"^16.2.7","@ast-grep/cli":"^0.40.4","@biomejs/biome":"2.3.10","@types/shell-quote":"^1.7.5","@opencode-ai/plugin":"^1.0.224"},"peerDependencies":{"typescript":"^5"},"trustedDependencies":["@ast-grep/cli"],"_npmOperationalInternal":{"tmp":"tmp/cc-safety-net_0.5.1_1768154390915_0.6453172219132681","host":"s3://npm-registry-packages-npm-production"}},"0.6.0":{"name":"cc-safety-net","version":"0.6.0","keywords":["claude-code","opencode","safety","plugin","security"],"author":{"name":"J Liew","email":"jliew@420024lab.com"},"license":"MIT","_id":"cc-safety-net@0.6.0","maintainers":[{"name":"kenryu","email":"ken0ryu@gmail.com"}],"homepage":"https://github.com/kenryu42/claude-code-safety-net#readme","bugs":{"url":"https://github.com/kenryu42/claude-code-safety-net/issues"},"bin":{"cc-safety-net":"dist/bin/cc-safety-net.js"},"dist":{"shasum":"8e4f6a04decbeb6e3f1b5f587a0b84c8b5c12457","tarball":"https://registry.npmjs.org/cc-safety-net/-/cc-safety-net-0.6.0.tgz","fileCount":41,"integrity":"sha512-Q5NPZI+XGFYux20rDFEyFq7UURXpYJknVGACdXBIVF6lvyJeR2DZbrziZZX49wMCxzoJqA1ck5LUVfRMWDJafw==","signatures":[{"sig":"MEUCIEgXK1Xc9IYiX19cFc8vcgBpLQfBZWxoH/HBgDRMe+dIAiEA8OyprmaHF23YaREjtmUyoN8I+vhUBFC8Tshnkj0jlHI=","keyid":"SHA256:DhQ8wR5APBvFHLF/+Tc+AYvPOdTpcIDqOhxsBHRwC7U"}],"attestations":{"url":"https://registry.npmjs.org/-/npm/v1/attestations/cc-safety-net@0.6.0","provenance":{"predicateType":"https://slsa.dev/provenance/v1"}},"unpackedSize":190946},"main":"dist/index.js","type":"module","types":"dist/index.d.ts","engines":{"node":">=18"},"gitHead":"272265fbb656f71ed4706593f2d361ecd6702536","scripts":{"knip":"knip --production","lint":"biome check --write","test":"bun test","build":"bun run scripts/build.ts","check":"bun run lint && bun run typecheck && bun run knip && bun run sg:scan && AGENT=1 bun test --coverage","clean":"rm -rf dist","prepare":"husky && bun run setup-hooks","sg:scan":"ast-grep scan","typecheck":"tsc --project tsconfig.typecheck.json","build:types":"tsc --emitDeclarationOnly --declaration --noEmit false","setup-hooks":"bun -e 'await Bun.write(\".husky/pre-commit\", \"#!/usr/bin/env sh\\n\\nbun run knip && bun run lint-staged\\n\")' && chmod +x .husky/pre-commit","build:schema":"bun run scripts/build-schema.ts","publish:dry-run":"bun run scripts/publish.ts --dry-run"},"_npmUser":{"name":"GitHub Actions","email":"npm-oidc-no-reply@github.com","trustedPublisher":{"id":"github","oidcConfigId":"oidc:28db2ca7-f17e-4d43-894b-e6eeff723077"}},"repository":{"url":"git+https://github.com/kenryu42/claude-code-safety-net.git","type":"git"},"_npmVersion":"11.7.0","description":"Claude Code / OpenCode plugin - block destructive git and filesystem commands before execution","directories":{},"_nodeVersion":"24.12.0","dependencies":{"shell-quote":"^1.8.3"},"_hasShrinkwrap":false,"devDependencies":{"zod":"^4.3.5","knip":"^5.79.0","husky":"^9.1.7","@types/bun":"latest","lint-staged":"^16.2.7","@ast-grep/cli":"^0.40.4","@biomejs/biome":"2.3.10","@types/shell-quote":"^1.7.5","@opencode-ai/plugin":"^1.0.224"},"peerDependencies":{"typescript":"^5"},"trustedDependencies":["@ast-grep/cli"],"_npmOperationalInternal":{"tmp":"tmp/cc-safety-net_0.6.0_1768496744284_0.06897869969878268","host":"s3://npm-registry-packages-npm-production"}},"0.6.1":{"name":"cc-safety-net","version":"0.6.1","keywords":["claude-code","opencode","safety","plugin","security"],"author":{"name":"J Liew","email":"jliew@420024lab.com"},"license":"MIT","_id":"cc-safety-net@0.6.1","maintainers":[{"name":"kenryu","email":"ken0ryu@gmail.com"}],"homepage":"https://github.com/kenryu42/claude-code-safety-net#readme","bugs":{"url":"https://github.com/kenryu42/claude-code-safety-net/issues"},"bin":{"cc-safety-net":"dist/bin/cc-safety-net.js"},"dist":{"shasum":"6e0a00415d40833d3549ba972142e07e0ff601cb","tarball":"https://registry.npmjs.org/cc-safety-net/-/cc-safety-net-0.6.1.tgz","fileCount":48,"integrity":"sha512-QFpQ7oVKaUdxpfkKWzpFis70LpXmQX97X1N2jZu8BPgKDxcveX9HHOk0SkQ+aHt8FTdrLChSo3Tzem0fYqbLfw==","signatures":[{"sig":"MEYCIQDwr6Ur20lhRw+THotqz0S29QE/CjGoBEvpKylRixe0uAIhAPg96js1KOiNjOJJZ1BY4WEynOXq1b5zZEeLkha/xtC/","keyid":"SHA256:DhQ8wR5APBvFHLF/+Tc+AYvPOdTpcIDqOhxsBHRwC7U"}],"attestations":{"url":"https://registry.npmjs.org/-/npm/v1/attestations/cc-safety-net@0.6.1","provenance":{"predicateType":"https://slsa.dev/provenance/v1"}},"unpackedSize":229745},"main":"dist/index.js","type":"module","types":"dist/index.d.ts","engines":{"node":">=18"},"gitHead":"369cc941edfd7bc1b7c78c1948ef27fd6f92531c","scripts":{"knip":"knip --production","lint":"biome check --write","test":"bun test","build":"bun run clean && bun run scripts/build.ts","check":"bun run lint && bun run typecheck && bun run knip && bun run sg:scan && AGENT=1 bun test --coverage","clean":"rm -rf dist","prepare":"husky && bun run setup-hooks","sg:scan":"ast-grep scan","typecheck":"tsc --project tsconfig.typecheck.json","build:types":"tsc --emitDeclarationOnly --declaration --noEmit false","setup-hooks":"bun -e 'await Bun.write(\".husky/pre-commit\", \"#!/usr/bin/env sh\\n\\nbun run knip && bun run lint-staged\\n\")' && chmod +x .husky/pre-commit","build:schema":"bun run scripts/build-schema.ts","publish:dry-run":"bun run scripts/publish.ts --dry-run"},"_npmUser":{"name":"GitHub Actions","email":"npm-oidc-no-reply@github.com","trustedPublisher":{"id":"github","oidcConfigId":"oidc:28db2ca7-f17e-4d43-894b-e6eeff723077"}},"repository":{"url":"git+https://github.com/kenryu42/claude-code-safety-net.git","type":"git"},"_npmVersion":"11.7.0","description":"Claude Code / OpenCode plugin - block destructive git and filesystem commands before execution","directories":{},"_nodeVersion":"24.12.0","dependencies":{"shell-quote":"^1.8.3"},"_hasShrinkwrap":false,"devDependencies":{"zod":"^4.3.5","knip":"^5.79.0","husky":"^9.1.7","@types/bun":"latest","lint-staged":"^16.2.7","@ast-grep/cli":"^0.40.4","@biomejs/biome":"2.3.10","@types/shell-quote":"^1.7.5","@opencode-ai/plugin":"^1.0.224"},"peerDependencies":{"typescript":"^5"},"trustedDependencies":["@ast-grep/cli"],"_npmOperationalInternal":{"tmp":"tmp/cc-safety-net_0.6.1_1768814726681_0.5718128898457779","host":"s3://npm-registry-packages-npm-production"}},"0.6.2":{"name":"cc-safety-net","version":"0.6.2","description":"Claude Code / OpenCode plugin - block destructive git and filesystem commands before execution","main":"dist/index.js","types":"dist/index.d.ts","type":"module","bin":{"cc-safety-net":"dist/bin/cc-safety-net.js"},"scripts":{"build":"bun run clean && bun run scripts/build.ts","build:types":"tsc --emitDeclarationOnly --declaration --noEmit false","build:schema":"bun run scripts/build-schema.ts","clean":"rm -rf dist","check":"bun run lint && bun run typecheck && bun run knip && bun run sg:scan && AGENT=1 bun test --coverage","lint":"biome check --write","typecheck":"tsc --project tsconfig.typecheck.json","knip":"knip --production","sg:scan":"ast-grep scan","test":"bun test","publish:dry-run":"bun run scripts/publish.ts --dry-run","prepare":"husky && bun run setup-hooks","setup-hooks":"bun -e 'await Bun.write(\".husky/pre-commit\", \"#!/usr/bin/env sh\\n\\nbun run knip && bun run lint-staged\\n\")' && chmod +x .husky/pre-commit"},"author":{"name":"J Liew","email":"jliew@420024lab.com"},"license":"MIT","repository":{"type":"git","url":"git+https://github.com/kenryu42/claude-code-safety-net.git"},"bugs":{"url":"https://github.com/kenryu42/claude-code-safety-net/issues"},"homepage":"https://github.com/kenryu42/claude-code-safety-net#readme","devDependencies":{"@ast-grep/cli":"^0.40.4","@biomejs/biome":"2.3.10","@opencode-ai/plugin":"^1.0.224","@types/bun":"latest","@types/shell-quote":"^1.7.5","husky":"^9.1.7","knip":"^5.79.0","lint-staged":"^16.2.7","zod":"^4.3.5"},"peerDependencies":{"typescript":"^5"},"dependencies":{"shell-quote":"^1.8.3"},"trustedDependencies":["@ast-grep/cli"],"engines":{"node":">=18"},"keywords":["claude-code","opencode","safety","plugin","security"],"gitHead":"772a4b2dd058f0e0d9b0125689979458f491cf81","_id":"cc-safety-net@0.6.2","_nodeVersion":"24.12.0","_npmVersion":"11.7.0","dist":{"integrity":"sha512-lHjPiJJ0+HYl9HjU2Dg/iy2CcR11ijyEHB2ACBBnR+6E05tPhcepQsBUZis7abyzm2u0q/2Qu982iNOAosjczA==","shasum":"774da3ba6e0501969846069d1a34ca02f138126b","tarball":"https://registry.npmjs.org/cc-safety-net/-/cc-safety-net-0.6.2.tgz","fileCount":48,"unpackedSize":229745,"attestations":{"url":"https://registry.npmjs.org/-/npm/v1/attestations/cc-safety-net@0.6.2","provenance":{"predicateType":"https://slsa.dev/provenance/v1"}},"signatures":[{"keyid":"SHA256:DhQ8wR5APBvFHLF/+Tc+AYvPOdTpcIDqOhxsBHRwC7U","sig":"MEYCIQCeiZnTYbDAL5juXbiKxcXz3Bd2PBJjYYPd0jJqhxrtfwIhAJMCNbkav5HbPl+sHzjhyoupUofSHREWkcxHkbmzjB41"}]},"_npmUser":{"name":"GitHub Actions","email":"npm-oidc-no-reply@github.com","trustedPublisher":{"id":"github","oidcConfigId":"oidc:28db2ca7-f17e-4d43-894b-e6eeff723077"}},"directories":{},"maintainers":[{"name":"kenryu","email":"ken0ryu@gmail.com"}],"_npmOperationalInternal":{"host":"s3://npm-registry-packages-npm-production","tmp":"tmp/cc-safety-net_0.6.2_1768815529966_0.9826782583231624"},"_hasShrinkwrap":false}},"time":{"created":"2026-01-03T13:04:57.694Z","modified":"2026-01-19T09:38:50.385Z","0.0.1":"2026-01-03T13:04:57.826Z","0.4.0":"2026-01-07T11:15:16.006Z","0.4.1":"2026-01-08T17:35:27.174Z","0.5.0":"2026-01-10T18:45:43.077Z","0.5.1":"2026-01-11T17:59:51.053Z","0.6.0":"2026-01-15T17:05:44.419Z","0.6.1":"2026-01-19T09:25:26.819Z","0.6.2":"2026-01-19T09:38:50.121Z"},"bugs":{"url":"https://github.com/kenryu42/claude-code-safety-net/issues"},"author":{"name":"J Liew","email":"jliew@420024lab.com"},"license":"MIT","homepage":"https://github.com/kenryu42/claude-code-safety-net#readme","keywords":["claude-code","opencode","safety","plugin","security"],"repository":{"type":"git","url":"git+https://github.com/kenryu42/claude-code-safety-net.git"},"description":"Claude Code / OpenCode plugin - block destructive git and filesystem commands before execution","maintainers":[{"name":"kenryu","email":"ken0ryu@gmail.com"}],"readme":"# Claude Code Safety Net\n\n[![CI](https://github.com/kenryu42/claude-code-safety-net/actions/workflows/ci.yml/badge.svg)](https://github.com/kenryu42/claude-code-safety-net/actions/workflows/ci.yml)\n[![codecov](https://codecov.io/github/kenryu42/claude-code-safety-net/branch/main/graph/badge.svg?token=C9QTION6ZF)](https://codecov.io/github/kenryu42/claude-code-safety-net)\n[![Version](https://img.shields.io/github/v/tag/kenryu42/claude-code-safety-net?label=version&color=blue)](https://github.com/kenryu42/claude-code-safety-net)\n[![Claude Code](https://img.shields.io/badge/Claude%20Code-D27656)](#claude-code-installation)\n[![OpenCode](https://img.shields.io/badge/OpenCode-black)](#opencode-installation)\n[![Gemini CLI](https://img.shields.io/badge/Gemini%20CLI-678AE3)](#gemini-cli-installation)\n[![License: MIT](https://img.shields.io/badge/License-MIT-red.svg)](https://opensource.org/licenses/MIT)\n\n<div align=\"center\">\n\n[![CC Safety Net](./.github/assets/cc-safety-net.png)](./.github/assets/cc-safety-net.png)\n\n</div>\n\nA Claude Code plugin that acts as a safety net, catching destructive git and filesystem commands before they execute.\n\n## Contents\n\n- [Why This Exists](#why-this-exists)\n- [Why Use This Instead of Permission Deny Rules?](#why-use-this-instead-of-permission-deny-rules)\n- [What About Sandboxing?](#what-about-sandboxing)\n- [Prerequisites](#prerequisites)\n- [Quick Start](#quick-start)\n  - [Claude Code Installation](#claude-code-installation)\n  - [OpenCode Installation](#opencode-installation)\n  - [Gemini CLI Installation](#gemini-cli-installation)\n- [Status Line Integration](#status-line-integration)\n  - [Setup via Slash Command](#setup-via-slash-command)\n  - [Manual Setup](#manual-setup)\n  - [Emoji Mode Indicators](#emoji-mode-indicators)\n- [Diagnostics](#diagnostics)\n- [Commands Blocked](#commands-blocked)\n- [Commands Allowed](#commands-allowed)\n- [What Happens When Blocked](#what-happens-when-blocked)\n- [Testing the Hook](#testing-the-hook)\n- [Development](#development)\n- [Custom Rules (Experimental)](#custom-rules-experimental)\n  - [Config File Location](#config-file-location)\n  - [Rule Schema](#rule-schema)\n  - [Matching Behavior](#matching-behavior)\n  - [Examples](#examples)\n  - [Error Handling](#error-handling)\n- [Advanced Features](#advanced-features)\n  - [Strict Mode](#strict-mode)\n  - [Paranoid Mode](#paranoid-mode)\n  - [Shell Wrapper Detection](#shell-wrapper-detection)\n  - [Interpreter One-Liner Detection](#interpreter-one-liner-detection)\n  - [Secret Redaction](#secret-redaction)\n  - [Audit Logging](#audit-logging)\n- [License](#license)\n\n## Why This Exists\n\nWe learned the [hard way](https://www.reddit.com/r/ClaudeAI/comments/1pgxckk/claude_cli_deleted_my_entire_home_directory_wiped/) that instructions aren't enough to keep AI agents in check.\nAfter Claude Code silently wiped out hours of progress with a single `rm -rf ~/` or `git checkout --`, it became evident that **soft** rules in an `CLAUDE.md` or `AGENTS.md` file cannot replace **hard** technical constraints.\nThe current approach is to use a dedicated hook to programmatically prevent agents from running destructive commands.\n\n## Why Use This Instead of Permission Deny Rules?\n\nClaude Code's `.claude/settings.json` supports [deny rules](https://code.claude.com/docs/en/iam#tool-specific-permission-rules) with wildcard matching (e.g., `Bash(git reset --hard:*)`). Here's how this plugin differs:\n\n### At a Glance\n\n| | Permission Deny Rules | Safety Net |\n|---|---|---|\n| **Setup** | Manual configuration required | Works out of the box |\n| **Parsing** | Wildcard pattern matching | Semantic command analysis |\n| **Execution order** | Runs second | Runs first (PreToolUse hook) |\n| **Shell wrappers** | Not handled automatically (must match wrapper forms) | Recursively analyzed (5 levels) |\n| **Interpreter one-liners** | Not handled automatically (must match interpreter forms) | Detected and blocked |\n\n### Permission Rules Have Known Bypass Vectors\n\nEven with wildcard matching, Bash permission patterns are intentionally limited and can be bypassed in many ways:\n\n| Bypass Method | Example |\n|---------------|---------|\n| Options before value | `curl -X GET http://evil.com` bypasses `Bash(curl http://evil.com:*)` |\n| Shell variables | `URL=http://evil.com && curl $URL` bypasses URL pattern |\n| Flag reordering | `rm -r -f /` bypasses `Bash(rm -rf:*)` |\n| Extra whitespace | `rm  -rf /` (double space) bypasses pattern |\n| Shell wrappers | `sh -c \"rm -rf /\"` bypasses `Bash(rm:*)` entirely |\n\n### Safety Net Handles What Patterns Can't\n\n| Scenario | Permission Rules | Safety Net |\n|----------|------------------|------------|\n| `git checkout -b feature` (safe) | Blocked by `Bash(git checkout:*)` | Allowed |\n| `git checkout -- file` (dangerous) | Blocked by `Bash(git checkout:*)` | Blocked |\n| `rm -rf /tmp/cache` (safe) | Blocked by `Bash(rm -rf:*)` | Allowed |\n| `rm -r -f /` (dangerous) | Allowed (flag order) | Blocked |\n| `bash -c 'git reset --hard'` | Allowed (wrapper) | Blocked |\n| `python -c 'os.system(\"rm -rf /\")'` | Allowed (interpreter) | Blocked |\n\n### Defense in Depth\n\nPreToolUse hooks run [**before**](https://code.claude.com/docs/en/iam#additional-permission-control-with-hooks) the permission system. This means Safety Net inspects every command first, regardless of your permission configuration. Even if you misconfigure deny rules, Safety Net provides a fallback layer of protection.\n\n**Use both together**: Permission deny rules for quick, user-configurable blocks; Safety Net for robust, bypass-resistant protection that works out of the box.\n\n## What About Sandboxing?\n\nClaude Code offers [native sandboxing](https://code.claude.com/docs/en/sandboxing) that provides OS-level filesystem and network isolation. Here's how it compares to Safety Net:\n\n### Different Layers of Protection\n\n| | Sandboxing | Safety Net |\n|---|---|---|\n| **Enforcement** | OS-level (Seatbelt/bubblewrap) | Application-level (PreToolUse hook) |\n| **Approach** | Containment ‚Äî restricts filesystem + network access | Command analysis ‚Äî blocks destructive operations |\n| **Filesystem** | Writes restricted (default: cwd); reads are broad by default | Only destructive operations blocked |\n| **Network** | Domain-based proxy filtering | None |\n| **Git awareness** | None | Explicit rules for destructive git operations |\n| **Bypass resistance** | High ‚Äî OS enforces boundaries | Lower ‚Äî analyzes command strings only |\n\n### Why Sandboxing Isn't Enough\n\nSandboxing restricts filesystem + network access, but it doesn't understand whether an operation is destructive within those boundaries. These commands are not blocked by the sandbox boundary:\n\n> [!NOTE]\n> Whether they're auto-run or require confirmation depends on your sandbox mode (auto-allow vs regular permissions), and network access still depends on your allowed-domain policy. Claude Code can also retry a command outside the sandbox via `dangerouslyDisableSandbox` (with user permission); this can be disabled with `allowUnsandboxedCommands: false`.\n\n| Command | Sandboxing | Safety Net |\n|---------|------------|------------|\n| `git reset --hard` | Allowed (within cwd) | **Blocked** |\n| `git checkout -- .` | Allowed (within cwd) | **Blocked** |\n| `git stash clear` | Allowed (within cwd) | **Blocked** |\n| `git push --force` | Allowed (if remote domain is allowed) | **Blocked** |\n| `rm -rf .` | Allowed (within cwd) | **Blocked** |\n\nSandboxing sees `git reset --hard` as a safe operation‚Äîit only modifies files within the current directory. But you just lost all uncommitted work.\n\n### When to Use Sandboxing Instead\n\nSandboxing is the better choice when your primary concern is:\n\n- **Prompt injection attacks** ‚Äî Reduces exfiltration risk by restricting outbound domains (depends on your allowed-domain policy)\n- **Malicious dependencies** ‚Äî Limits filesystem writes and network access by default (subject to your sandbox configuration)\n- **Untrusted code execution** ‚Äî OS-level containment is stronger than pattern matching\n- **Network control** ‚Äî Safety Net has no network protection\n\n### Recommended: Use Both\n\nThey protect against different threats:\n\n- **Sandboxing** contains blast radius ‚Äî even if something goes wrong, damage is limited to cwd and approved network domains\n- **Safety Net** prevents footguns ‚Äî catches git-specific mistakes that are technically \"safe\" from the sandbox's perspective\n\nRunning both together provides defense-in-depth. Sandboxing handles unknown threats; Safety Net handles known destructive patterns that sandboxing permits.\n\n## Prerequisites\n\n- **Node.js**: Version 18 or higher is required to run this plugin\n\n## Quick Start\n\n### Claude Code Installation\n\n```bash\n/plugin marketplace add kenryu42/cc-marketplace\n/plugin install safety-net@cc-marketplace\n```\n\n> [!NOTE]\n> After installing the plugin, you need to restart your Claude Code for it to take effect.\n\n### Claude Code Auto-Update\n\n1. Run `/plugin` ‚Üí Select `Marketplaces` ‚Üí Choose `cc-marketplace` ‚Üí Enable auto-update\n\n---\n\n### OpenCode Installation\n\n**Option A: Let an LLM do it**\n\nPaste this into any LLM agent (Claude Code, OpenCode, Cursor, etc.):\n\n```\nInstall the cc-safety-net plugin in `~/.config/opencode/opencode.json` (or `.jsonc`) according to the schema at: https://opencode.ai/config.json\n```\n\n**Option B: Manual setup**\n\n1. **Add the plugin to your config** `~/.config/opencode/opencode.json` (or `.jsonc`):\n\n  ```json\n  {\n    \"plugin\": [\"cc-safety-net\"]\n  }\n  ```\n\n---\n\n### Gemini CLI Installation\n\n```bash\ngemini extensions install https://github.com/kenryu42/gemini-safety-net\n```\n\n> [!IMPORTANT]\n> You need to set the following settings in `.gemini/settings.json` to enable hooks:\n> ```json\n> {\n>   \"tools\": {\n>     \"enableHooks\": true\n>   }\n> }\n> ```\n\n## Status Line Integration\n\nSafety Net can display its status in Claude Code's status line, showing whether protection is active and which modes are enabled.\n\n### Setup via Slash Command\n\nThe easiest way to configure the status line is using the built-in slash command:\n\n```\n/set-statusline\n```\n\nThis interactive command will:\n1. Ask whether you prefer `bunx` or `npx`\n2. Check for existing status line configuration\n3. Offer to replace or pipe with existing commands\n4. Write the configuration to `~/.claude/settings.json`\n\n### Manual Setup\n\nAdd the following to your `~/.claude/settings.json`:\n\n**Using Bun (recommended):**\n\n```json\n{\n  \"statusLine\": {\n    \"type\": \"command\",\n    \"command\": \"bunx cc-safety-net --statusline\"\n  }\n}\n```\n\n**Using npm:**\n\n```json\n{\n  \"statusLine\": {\n    \"type\": \"command\",\n    \"command\": \"npx -y cc-safety-net --statusline\"\n  }\n}\n```\n\n**Piping with existing status line:**\n\nIf you already have a status line command, you can pipe Safety Net at the end:\n\n```json\n{\n  \"statusLine\": {\n    \"type\": \"command\",\n    \"command\": \"your-existing-command | bunx cc-safety-net --statusline\"\n  }\n}\n```\n\nChanges take effect immediately ‚Äî no restart needed.\n\n### Emoji Mode Indicators\n\nThe status line displays different emojis based on the current configuration:\n\n| Status | Display | Meaning |\n|--------|---------|---------|\n| Plugin disabled | `üõ°Ô∏è Safety Net ‚ùå` | Safety Net plugin is not enabled |\n| Default mode | `üõ°Ô∏è Safety Net ‚úÖ` | Protection active with default settings |\n| Strict mode | `üõ°Ô∏è Safety Net üîí` | `SAFETY_NET_STRICT=1` ‚Äî fail-closed on unparseable commands |\n| Paranoid mode | `üõ°Ô∏è Safety Net üëÅÔ∏è` | `SAFETY_NET_PARANOID=1` ‚Äî all paranoid checks enabled |\n| Paranoid RM only | `üõ°Ô∏è Safety Net üóëÔ∏è` | `SAFETY_NET_PARANOID_RM=1` ‚Äî blocks `rm -rf` even within cwd |\n| Paranoid interpreters only | `üõ°Ô∏è Safety Net üêö` | `SAFETY_NET_PARANOID_INTERPRETERS=1` ‚Äî blocks interpreter one-liners |\n| Strict + Paranoid | `üõ°Ô∏è Safety Net üîíüëÅÔ∏è` | Both strict and paranoid modes enabled |\n\nMultiple mode emojis are combined when multiple environment variables are set.\n\n## Diagnostics\n\nRun the diagnostic command to verify your installation and troubleshoot issues:\n\n```bash\nnpx cc-safety-net doctor\n# or with bun\nbunx cc-safety-net doctor\n```\n\nThe doctor command checks:\n\n| Check | Description |\n|-------|-------------|\n| Hook Integration | Verifies the plugin is properly configured for each supported platform |\n| Self-Test | Runs sample commands to confirm blocking works correctly |\n| Configuration | Validates custom rules in user and project configs |\n| Environment | Shows status of mode flags (SAFETY_NET_STRICT, SAFETY_NET_PARANOID, etc.) |\n| Recent Activity | Summarizes blocked commands from the last 7 days |\n| System Info | Displays versions of all relevant tools |\n| Update Check | Checks if a newer version is available |\n\n### Options\n\n| Flag | Description |\n|------|-------------|\n| `--json` | Output in JSON format (useful for sharing in bug reports) |\n| `--skip-update-check` | Skip the npm version check |\n\n## Commands Blocked\n\n| Command Pattern | Why It's Dangerous |\n|-----------------|-------------------|\n| git checkout -- files | Discards uncommitted changes permanently |\n| git checkout \\<ref\\> -- \\<path\\> | Overwrites working tree with ref version |\n| git restore files | Discards uncommitted changes |\n| git restore --worktree | Explicitly discards working tree changes |\n| git reset --hard | Destroys all uncommitted changes |\n| git reset --merge | Can lose uncommitted changes |\n| git clean -f | Removes untracked files permanently |\n| git push --force / -f | Destroys remote history |\n| git branch -D | Force-deletes branch without merge check |\n| git stash drop | Permanently deletes stashed changes |\n| git stash clear | Deletes ALL stashed changes |\n| git worktree remove --force | Force-deletes worktree without checking for changes |\n| rm -rf (paths outside cwd) | Recursive file deletion outside the current directory |\n| rm -rf / or ~ or $HOME | Root/home deletion is extremely dangerous |\n| find ... -delete | Permanently removes files matching criteria |\n| xargs rm -rf | Dynamic input makes targets unpredictable |\n| xargs \\<shell\\> -c | Can execute arbitrary commands |\n| parallel rm -rf | Dynamic input makes targets unpredictable |\n| parallel \\<shell\\> -c | Can execute arbitrary commands |\n\n## Commands Allowed\n\n| Command Pattern | Why It's Safe |\n|-----------------|--------------|\n| git checkout -b branch | Creates new branch |\n| git checkout --orphan | Creates orphan branch |\n| git restore --staged | Only unstages, doesn't discard |\n| git restore --help/--version | Help/version output |\n| git branch -d | Safe delete with merge check |\n| git clean -n / --dry-run | Preview only |\n| git push --force-with-lease | Safe force push |\n| rm -rf /tmp/... | Temp directories are ephemeral |\n| rm -rf /var/tmp/... | System temp directory |\n| rm -rf $TMPDIR/... | User's temp directory |\n| rm -rf ./... (within cwd) | Limited to current working directory |\n\n## What Happens When Blocked\n\nWhen a destructive command is detected, the plugin blocks the tool execution and provides a reason.\n\nExample output:\n```text\nBLOCKED by Safety Net\n\nReason: git checkout -- discards uncommitted changes permanently. Use 'git stash' first.\n\nCommand: git checkout -- src/main.py\n\nIf this operation is truly needed, ask the user for explicit permission and have them run the command manually.\n```\n\n## Testing the Hook\n\nYou can manually test the hook by attempting to run blocked commands in Claude Code:\n\n```bash\n# This should be blocked\ngit checkout -- README.md\n\n# This should be allowed\ngit checkout -b test-branch\n```\n\n## Development\n\nSee [CONTRIBUTING.md](CONTRIBUTING.md) for details on how to contribute to this project.\n\n## Custom Rules (Experimental)\n\nBeyond the built-in protections, you can define your own blocking rules to enforce team conventions or project-specific safety policies.\n\n> [!TIP]\n> Use `/set-custom-rules` to create custom rules interactively with natural language.\n\n### Quick Example\n\nCreate `.safety-net.json` in your project root:\n\n```json\n{\n  \"version\": 1,\n  \"rules\": [\n    {\n      \"name\": \"block-git-add-all\",\n      \"command\": \"git\",\n      \"subcommand\": \"add\",\n      \"block_args\": [\"-A\", \"--all\", \".\"],\n      \"reason\": \"Use 'git add <specific-files>' instead of blanket add.\"\n    }\n  ]\n}\n```\n\nNow `git add -A`, `git add --all`, and `git add .` will be blocked with your custom message.\n\n### Config File Location\n\nConfig files are loaded from two scopes and merged:\n\n1. **User scope**: `~/.cc-safety-net/config.json` (always loaded if exists)\n2. **Project scope**: `.safety-net.json` in the current working directory (loaded if exists)\n\n**Merging behavior**:\n- Rules from both scopes are combined\n- If the same rule name exists in both scopes, **project scope wins**\n- Rule name comparison is case-insensitive (`MyRule` and `myrule` are considered duplicates)\n\nThis allows you to define personal defaults in user scope while letting projects override specific rules.\n\nIf no config file is found in either location, only built-in rules apply.\n\n### Config Schema\n\n| Field | Type | Required | Description |\n|-------|------|----------|-------------|\n| `version` | integer | Yes | Schema version (must be `1`) |\n| `rules` | array | No | List of custom blocking rules (defaults to empty) |\n\n### Rule Schema\n\n| Field | Type | Required | Description |\n|-------|------|----------|-------------|\n| `name` | string | Yes | Unique identifier (letters, numbers, hyphens, underscores; max 64 chars) |\n| `command` | string | Yes | Base command to match (e.g., `git`, `npm`, `docker`) |\n| `subcommand` | string | No | Subcommand to match (e.g., `add`, `install`). If omitted, matches any. |\n| `block_args` | array | Yes | Arguments that trigger the block (at least one required) |\n| `reason` | string | Yes | Message shown when blocked (max 256 chars) |\n\n### Matching Behavior\n\n- **Commands** are normalized to basename (`/usr/bin/git` ‚Üí `git`)\n- **Subcommand** is the first non-option argument after the command\n- **Arguments** are matched literally (no regex, no glob), with short option expansion\n- A command is blocked if **any** argument in `block_args` is present\n- **Short options** are expanded: `-Ap` matches `-A` (bundled flags are unbundled)\n- **Long options** use exact match: `--all-files` does NOT match `--all`\n- Custom rules only add restrictions‚Äîthey cannot bypass built-in protections\n\n#### Known Limitations\n\n- **Short option expansion**: `-Cfoo` is treated as `-C -f -o -o`, not `-C foo`. Blocking `-f` may false-positive on attached option values.\n\n### Examples\n\n#### Block global npm installs\n\n```json\n{\n  \"version\": 1,\n  \"rules\": [\n    {\n      \"name\": \"block-npm-global\",\n      \"command\": \"npm\",\n      \"subcommand\": \"install\",\n      \"block_args\": [\"-g\", \"--global\"],\n      \"reason\": \"Global npm installs can cause version conflicts. Use npx or local install.\"\n    }\n  ]\n}\n```\n\n#### Block dangerous docker commands\n\n```json\n{\n  \"version\": 1,\n  \"rules\": [\n    {\n      \"name\": \"block-docker-system-prune\",\n      \"command\": \"docker\",\n      \"subcommand\": \"system\",\n      \"block_args\": [\"prune\"],\n      \"reason\": \"docker system prune removes all unused data. Use targeted cleanup instead.\"\n    }\n  ]\n}\n```\n\n#### Multiple rules\n\n```json\n{\n  \"version\": 1,\n  \"rules\": [\n    {\n      \"name\": \"block-git-add-all\",\n      \"command\": \"git\",\n      \"subcommand\": \"add\",\n      \"block_args\": [\"-A\", \"--all\", \".\", \"-u\", \"--update\"],\n      \"reason\": \"Use 'git add <specific-files>' instead of blanket add.\"\n    },\n    {\n      \"name\": \"block-npm-global\",\n      \"command\": \"npm\",\n      \"subcommand\": \"install\",\n      \"block_args\": [\"-g\", \"--global\"],\n      \"reason\": \"Use npx or local install instead of global.\"\n    }\n  ]\n}\n```\n\n### Error Handling\n\nCustom rules use **silent fallback** error handling. If your config file is invalid, the safety net silently falls back to built-in rules only:\n\n| Scenario | Behavior |\n|----------|----------|\n| Config file not found | Silent ‚Äî use built-in rules only |\n| Empty config file | Silent ‚Äî use built-in rules only |\n| Invalid JSON syntax | Silent ‚Äî use built-in rules only |\n| Missing required field | Silent ‚Äî use built-in rules only |\n| Invalid field format | Silent ‚Äî use built-in rules only |\n| Duplicate rule name | Silent ‚Äî use built-in rules only |\n\n\n> [!IMPORTANT]  \n> If you add or modify custom rules manually, always validate them with `npx -y cc-safety-net --verify-config` or `/verify-custom-rules` slash command in your coding agent.\n\n### Block Output Format\n\nWhen a custom rule blocks a command, the output includes the rule name:\n\n```text\nBLOCKED by Safety Net\n\nReason: [block-git-add-all] Use 'git add <specific-files>' instead of blanket add.\n\nCommand: git add -A\n```\n\n## Advanced Features\n\n### Strict Mode\n\nBy default, unparseable commands are allowed through. Enable strict mode to fail-closed\nwhen the hook input or shell command cannot be safely analyzed (e.g., invalid JSON,\nunterminated quotes, malformed `bash -c` wrappers):\n\n```bash\nexport SAFETY_NET_STRICT=1\n```\n\n### Paranoid Mode\n\nParanoid mode enables stricter safety checks that may be disruptive to normal workflows.\nYou can enable it globally or via focused toggles:\n\n```bash\n# Enable all paranoid checks\nexport SAFETY_NET_PARANOID=1\n\n# Or enable specific paranoid checks\nexport SAFETY_NET_PARANOID_RM=1\nexport SAFETY_NET_PARANOID_INTERPRETERS=1\n```\n\nParanoid behavior:\n\n- **rm**: blocks non-temp `rm -rf` even within the current working directory.\n- **interpreters**: blocks interpreter one-liners like `python -c`, `node -e`, `ruby -e`,\n  and `perl -e` (these can hide destructive commands).\n\n### Shell Wrapper Detection\n\nThe guard recursively analyzes commands wrapped in shells:\n\n```bash\nbash -c 'git reset --hard'    # Blocked\nsh -lc 'rm -rf /'             # Blocked\n```\n\n### Interpreter One-Liner Detection\n\nDetects destructive commands hidden in Python/Node/Ruby/Perl one-liners:\n\n```bash\npython -c 'import os; os.system(\"rm -rf /\")'  # Blocked\n```\n\n### Secret Redaction\n\nBlock messages automatically redact sensitive data (tokens, passwords, API keys) to prevent leaking secrets in logs.\n\n### Audit Logging\n\nAll blocked commands are logged to `~/.cc-safety-net/logs/<session_id>.jsonl` for audit purposes:\n\n```json\n{\"ts\": \"2025-01-15T10:30:00Z\", \"command\": \"git reset --hard\", \"segment\": \"git reset --hard\", \"reason\": \"...\", \"cwd\": \"/path/to/project\"}\n```\n\nSensitive data in log entries is automatically redacted.\n\n## License\n\nMIT\n","readmeFilename":"README.md"}